import{f as J}from"./wallpaper-VN99naTl.js";import{q as Y,b as d,F as O,j as N,x as q,e as t,B as Q,p as r,d as X,r as v,c as R,u as F,l as A,A as B,k as G,n as _,f as E,t as y,h as m,g as w,_ as k,C as Z,o as P,a as ee}from"./index-BwwhmSGQ.js";import"./request-C7OBr44B.js";function te(s,a){let n=null;return function(){clearTimeout(n),n=setTimeout(()=>{s.apply(this,arguments)},a)}}function ae(s,a){var n=null;return function(){var h=this,p=arguments;n||(n=setTimeout(function(){s.apply(h,p),n=null},a))}}function H(s,a){return new RegExp("(^|\\s)"+a+"(\\s|$)").test(s.className)}function j(s,a){if(H(s,a))return;const n=s.className.split(/\s+/);n.push(a),s.className=n.join(" ")}const ie=document.createElement("div").style,U=(()=>{const s={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(const a in s)if(ie[s[a]]!==void 0)return a;return!1})();function se(s){return U===!1?!1:U==="standard"?s:U+s.charAt(0).toUpperCase()+s.substr(1)}const ne=se("transform"),le={name:"Waterfall",props:{list:{type:Array,default:()=>[]},gutter:{type:Number,default:6},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},animationEffect:{type:String,default:"fadeIn"},animationDuration:{type:String,default:"0s"},animationDelay:{type:String,default:".0s"},backgroundColor:{type:String,default:"#fff"}},data(){return{grid:null,gridItem:[],containerWidth:-1,itemsPosX:[],itemsPosY:[]}},computed:{itemWidth(){if(this.containerWidth===-1)return 0;{const s=Object.keys(this.breakpoints).map(a=>Number(a)).sort((a,n)=>a-n);for(let a=0;a<s.length;a++){const n=s[a];if(this.containerWidth!==0&&this.containerWidth<=n)return Math.floor((this.containerWidth-this.gutter)/this.breakpoints[n].rowPerView-this.gutter)}return this.width}},rowCount(){return this.containerWidth===-1?0:Math.floor((this.containerWidth-this.gutter)/(this.itemWidth+this.gutter))},shiftX(){const s=this.rowCount*(this.itemWidth+this.gutter)+this.gutter;return(this.containerWidth-s)/2},containerHeight(){return this.itemsPosY.slice(0).sort((s,a)=>s-a).pop()},containerStyle(){return{height:`${this.containerHeight}px`,background:this.backgroundColor}}},watch:{list:{handler:function(s){this.containerWidth=this.grid.clientWidth,this.$nextTick(()=>{this.calcPos()})}}},mounted(){window.onresize=te(this.resize,100)},beforeUpdate(){this.gridItem=[]},methods:{setGridRef(s){s&&(this.grid=s)},setGridItemRef(s){s&&this.gridItem.push(s)},calcPos(){this.itemsPosX=[],this.itemsPosY=[];const s=this.gridItem;if(s){for(let a=0;a<this.rowCount;a++)this.itemsPosX.push(this.shiftX+this.gutter*(a+1)+this.itemWidth*a),this.itemsPosY.push(this.gutter);s.forEach(a=>{const n=this.itemsPosY.slice(0).sort((b,z)=>b-z).shift(),h=this.itemsPosY.indexOf(n),p=this.itemsPosX[h],c=n;a.style.visibility="hidden",a.style[ne]="translate3d("+p+"px,"+c+"px, 0)",this.itemsPosY[h]+=a.getBoundingClientRect().height+this.gutter;const u=a.firstChild;H(u,"animated")||(u.style["animation-duration"]=this.animationDuration,u.style["-webkit-animation-duration"]=this.animationDuration,u.style["animation-delay"]=this.animationDelay,u.style["-webkit-animation-delay"]=this.animationDelay,u.style.visibility="visible",j(u,"animated"),j(u,this.animationEffect))})}},resize(){this.containerWidth=this.grid.clientWidth,this.$nextTick(()=>{this.calcPos()})},refresh:ae(function(){this.containerWidth=this.grid.clientWidth,this.$nextTick(()=>{this.calcPos()})},300)}},oe={class:"waterfull-item-box"};function re(s,a,n,h,p,c){return r(),d("div",{ref:c.setGridRef,class:"waterfull-grid",style:q(c.containerStyle)},[(r(!0),d(O,null,N(n.list,(u,b)=>(r(),d("div",{ref_for:!0,ref:c.setGridItemRef,key:b,class:"waterfull-item",style:q({width:`${c.itemWidth}px`})},[t("div",oe,[Q(s.$slots,"item",{data:{...u,itemWidth:c.itemWidth}},void 0)])],4))),128))],4)}const D=Y(le,[["render",re],["__scopeId","data-v-5f99d478"]]);D.install=s=>s.component(D.name,D);const ce={key:0,class:"gallery"},de=["onClick"],ue={class:"media"},he=["src","alt","onLoad"],ve={class:"overlay"},pe={class:"overlay-top"},ye={class:"overlay-title text-truncate"},be={key:0,class:"overlay-tags"},fe={class:"overlay-center"},me=["onClick"],ke={class:"overlay-bottom"},ge={class:"overlay-stats"},_e={class:"stat"},we={class:"stat"},Ce={class:"overlay-actions"},$e=["onClick"],xe=["onClick"],Se=["onClick"],Te={key:1,class:"gallery"},We=["onClick"],ze={class:"phone-shell"},Ve={class:"phone-screen"},Ie={class:"media phone-ratio"},Le=["src","alt","onLoad"],Re={class:"overlay"},Me={class:"overlay-top"},Ee={class:"overlay-title text-truncate"},Oe={key:0,class:"overlay-tags"},Ne={class:"overlay-center"},Ae=["onClick"],De={class:"overlay-bottom"},Ye={class:"overlay-stats"},Be={class:"stat"},Ge={class:"stat"},Ue={class:"overlay-actions"},Xe=["onClick"],qe=["onClick"],je=["onClick"],Fe={key:2,class:"gallery"},He=["onClick"],Ke={class:"avatar-square"},Je=["src","alt","onLoad"],Qe="wallpaper_detail_item",Ze=X({__name:"WallpaperGallery",props:{category:{},list:{},loading:{type:Boolean}},setup(s){const a=s,n=v(new Set),h=v(new Set),p=v(null),c=v(null),u=Z(),b=o=>n.value.has(o),z=o=>h.value.has(o),C=o=>{window.open(o.url,"_blank")},V=o=>{try{window.sessionStorage.setItem(Qe,JSON.stringify(o))}catch{}u.push(`/wallpapers/${o.id}`)},x=o=>{const i=new Set(h.value);i.has(o)?i.delete(o):i.add(o),h.value=i},f=o=>{window.open(o.url,"_blank")},$=async o=>{try{await navigator.clipboard.writeText(o.url),p.value=o.id,window.setTimeout(()=>{p.value===o.id&&(p.value=null)},900)}catch{}},g=(o,i)=>`${o}×${i}`,S=(o,i)=>`${(o*i*3/1024/1024).toFixed(1)}MB`,T=(o,i)=>{if(!i)return;const e=new Set(n.value);e.add(o.id),n.value=e,c.value?.refresh?.()},W=o=>[{loaded:b(o)}],I=R(()=>({gutter:14,width:268,breakpoints:{1400:{rowPerView:5},1100:{rowPerView:4},850:{rowPerView:3},620:{rowPerView:2},480:{rowPerView:1}}})),M=R(()=>({gutter:14,width:210,breakpoints:{1400:{rowPerView:6},1100:{rowPerView:5},850:{rowPerView:4},620:{rowPerView:3},480:{rowPerView:2}}})),L=R(()=>({gutter:14,width:120,breakpoints:{1400:{rowPerView:10},1100:{rowPerView:9},850:{rowPerView:7},620:{rowPerView:5},480:{rowPerView:4}}}));return F(()=>a.category,()=>{n.value=new Set,p.value=null,h.value=new Set,c.value=null}),(o,i)=>a.category==="desktop"?(r(),d("div",ce,[(r(),A(B(D),{ref_key:"waterfallRef",ref:c,key:"desktop",list:a.list,gutter:I.value.gutter,width:I.value.width,breakpoints:I.value.breakpoints,animationEffect:"fadeIn",backgroundColor:"transparent"},{item:G(e=>[t("button",{class:"card-btn",type:"button",onClick:l=>C(e.data)},[t("div",ue,[t("div",{class:_(["img-skeleton",W(e.data.id)])},null,2),t("img",{class:_(["img",{loaded:b(e.data.id)}]),src:e.data.thumbUrl,alt:e.data.title,loading:"lazy",onLoad:l=>T(e.data,l.target)},null,42,he),t("div",ve,[t("div",pe,[t("div",ye,y(e.data.title),1),e.data.tags?.length?(r(),d("div",be,[(r(!0),d(O,null,N(e.data.tags.slice(0,3),l=>(r(),d("span",{key:l,class:"tag-chip"},y(l),1))),128))])):E("",!0)]),t("div",fe,[t("button",{class:"go-btn",type:"button",onClick:m(l=>V(e.data),["stop","prevent"])}," 前往 ",8,me)]),t("div",ke,[t("div",ge,[t("span",_e,y(g(e.data.width,e.data.height)),1),i[0]||(i[0]=t("span",{class:"dot"},null,-1)),t("span",we,y(S(e.data.width,e.data.height)),1)]),t("div",Ce,[t("button",{class:"overlay-btn",type:"button",onClick:m(l=>f(e.data),["stop","prevent"]),title:"下载"},[w(k,{name:"ri-download-2-line",size:18})],8,$e),t("button",{class:"overlay-btn",type:"button",onClick:m(l=>x(e.data.id),["stop","prevent"]),title:"收藏"},[w(k,{name:z(e.data.id)?"ri-heart-3-fill":"ri-heart-3-line",size:18},null,8,["name"])],8,xe),t("button",{class:"overlay-btn",type:"button",onClick:m(l=>$(e.data),["stop","prevent"]),title:"复制链接"},[w(k,{name:p.value===e.data.id?"ri-check-line":"ri-link",size:18},null,8,["name"])],8,Se)])])])])],8,de)]),_:1},8,["list","gutter","width","breakpoints"]))])):a.category==="mobile"?(r(),d("div",Te,[(r(),A(B(D),{ref_key:"waterfallRef",ref:c,key:"mobile",list:a.list,gutter:M.value.gutter,width:M.value.width,breakpoints:M.value.breakpoints,animationEffect:"fadeIn",backgroundColor:"transparent"},{item:G(e=>[t("button",{class:"card-btn",type:"button",onClick:l=>C(e.data)},[t("div",ze,[i[2]||(i[2]=t("div",{class:"phone-top","aria-hidden":"true"},[t("span",{class:"phone-hole"}),t("span",{class:"phone-speaker"})],-1)),t("div",Ve,[t("div",Ie,[t("div",{class:_(["img-skeleton",W(e.data.id)])},null,2),t("img",{class:_(["img",{loaded:b(e.data.id)}]),src:e.data.thumbUrl,alt:e.data.title,loading:"lazy",onLoad:l=>T(e.data,l.target)},null,42,Le),t("div",Re,[t("div",Me,[t("div",Ee,y(e.data.title),1),e.data.tags?.length?(r(),d("div",Oe,[(r(!0),d(O,null,N(e.data.tags.slice(0,3),l=>(r(),d("span",{key:l,class:"tag-chip"},y(l),1))),128))])):E("",!0)]),t("div",Ne,[t("button",{class:"go-btn",type:"button",onClick:m(l=>V(e.data),["stop","prevent"])}," 前往 ",8,Ae)]),t("div",De,[t("div",Ye,[t("span",Be,y(g(e.data.width,e.data.height)),1),i[1]||(i[1]=t("span",{class:"dot"},null,-1)),t("span",Ge,y(S(e.data.width,e.data.height)),1)]),t("div",Ue,[t("button",{class:"overlay-btn",type:"button",onClick:m(l=>f(e.data),["stop","prevent"]),title:"下载"},[w(k,{name:"ri-download-2-line",size:18})],8,Xe),t("button",{class:"overlay-btn",type:"button",onClick:m(l=>x(e.data.id),["stop","prevent"]),title:"收藏"},[w(k,{name:z(e.data.id)?"ri-heart-3-fill":"ri-heart-3-line",size:18},null,8,["name"])],8,qe),t("button",{class:"overlay-btn",type:"button",onClick:m(l=>$(e.data),["stop","prevent"]),title:"复制链接"},[w(k,{name:p.value===e.data.id?"ri-check-line":"ri-link",size:18},null,8,["name"])],8,je)])])])])])])],8,We)]),_:1},8,["list","gutter","width","breakpoints"]))])):(r(),d("div",Fe,[(r(),A(B(D),{ref_key:"waterfallRef",ref:c,key:"avatar",list:a.list,gutter:L.value.gutter,width:L.value.width,breakpoints:L.value.breakpoints,animationEffect:"fadeIn",backgroundColor:"transparent"},{item:G(e=>[t("button",{class:"avatar-btn",type:"button",onClick:l=>C(e.data)},[t("div",Ke,[t("div",{class:_(["img-skeleton",W(e.data.id)])},null,2),t("img",{class:_(["img",{loaded:b(e.data.id)}]),src:e.data.thumbUrl,alt:e.data.title,loading:"lazy",onLoad:l=>T(e.data,l.target)},null,42,Je)])],8,He)]),_:1},8,["list","gutter","width","breakpoints"]))]))}}),Pe=Y(Ze,[["__scopeId","data-v-2010b5fb"]]),et={class:"header"},tt={class:"head-row"},at={class:"titles"},it={class:"h1"},st={class:"title-ico"},nt={class:"title-text"},lt={class:"right"},ot={class:"search-pill"},rt=["disabled"],ct={class:"type-btn-text"},dt=["onClick"],ut={class:"type-opt-text"},ht={class:"pill-input"},vt=["value","disabled"],pt=["disabled"],yt=["disabled"],bt=["onClick"],ft={class:"chip-opt-text"},mt={class:"sort seg",role:"group","aria-label":"排序"},kt=["onClick"],gt=X({__name:"WallpaperSearchHeader",props:{mediaType:{},keyword:{},loading:{type:Boolean},sort:{},total:{},title:{},subTitle:{},chips:{},activeChip:{}},emits:["changeMediaType","update:keyword","search","changeSort","selectChip"],setup(s,{emit:a}){const n=s,h=a;function p(){h("search")}const c=v(!1),u=v(null),b=[{value:"image",label:"图片"},{value:"video",label:"视频"}],z=R(()=>b.find(o=>o.value===n.mediaType)?.label??"图片"),C=()=>{n.loading||(c.value=!c.value)},V=()=>{c.value=!1},x=o=>{h("changeMediaType",o),V()},f=[{value:"default",label:"热门"},{value:"newest",label:"最新"},{value:"pixels",label:"分辨率"}],$=o=>{h("changeSort",o)},g=v(!1),S=v(null),T=()=>{n.loading||(g.value=!g.value)},W=()=>{g.value=!1},I=o=>{h("selectChip",o),W()},M=()=>{const o=n.chips?.find(i=>i.key==="all")?.key;I(o||n.chips?.[0]?.key||"all")},L=o=>{const i=o.target;if(i){if(c.value){if(u.value&&u.value.contains(i))return;V()}if(g.value){if(S.value&&S.value.contains(i))return;W()}}};return P(()=>{window.addEventListener("click",L)}),ee(()=>{window.removeEventListener("click",L)}),(o,i)=>(r(),d("div",et,[t("div",tt,[t("div",at,[t("div",it,[t("span",st,[w(k,{name:"ri-image-2-line",size:18})]),t("span",nt,y(s.title),1)])]),t("div",lt,[t("form",{class:"search",onSubmit:m(p,["prevent"])},[t("div",ot,[t("div",{ref_key:"mediaAnchorRef",ref:u,class:"pill-type"},[t("button",{type:"button",class:"type-btn",disabled:s.loading,onClick:m(C,["stop"])},[t("span",ct,y(z.value),1),w(k,{name:"ri-arrow-down-s-line",class:"type-caret"})],8,rt),c.value?(r(),d("div",{key:0,class:"type-pop",onClick:i[0]||(i[0]=m(()=>{},["stop"]))},[(r(),d(O,null,N(b,e=>t("button",{key:e.value,type:"button",class:_(["type-opt",{active:e.value===n.mediaType}]),onClick:l=>x(e.value)},[t("span",ut,y(e.label),1),e.value===n.mediaType?(r(),A(k,{key:0,name:"ri-check-line",class:"type-opt-check"})):E("",!0)],10,dt)),64))])):E("",!0)],512),t("div",ht,[t("input",{class:"ipt",value:s.keyword,disabled:s.loading,placeholder:"搜索壁纸...",onInput:i[1]||(i[1]=e=>h("update:keyword",e.target.value))},null,40,vt)]),t("button",{class:"pill-btn",type:"submit",disabled:s.loading,title:"搜索"},[w(k,{name:"ri-search-line",size:18}),i[3]||(i[3]=t("span",{class:"pill-btn-text"},"搜索",-1))],8,pt)])],32),t("div",{ref_key:"chipAnchorRef",ref:S,class:"chip-filter"},[t("button",{type:"button",class:"chip-btn",disabled:s.loading,onClick:m(T,["stop"])},[w(k,{name:"ri-filter-3-line",size:16}),i[4]||(i[4]=t("span",{class:"chip-btn-text"},"高级筛选",-1)),w(k,{name:"ri-arrow-down-s-line",class:"chip-caret"})],8,yt),g.value?(r(),d("div",{key:0,class:"chip-pop",onClick:i[2]||(i[2]=m(()=>{},["stop"]))},[t("button",{type:"button",class:"chip-reset",onClick:M}," 清空筛选 "),(r(!0),d(O,null,N(n.chips,e=>(r(),d("button",{key:e.key,type:"button",class:_(["chip-opt",{active:e.key===n.activeChip}]),onClick:l=>I(e.key)},[t("span",ft,y(e.label),1),e.key===n.activeChip?(r(),A(k,{key:0,name:"ri-check-line",class:"chip-opt-check"})):E("",!0)],10,bt))),128))])):E("",!0)],512),t("div",mt,[(r(),d(O,null,N(f,e=>t("button",{key:e.value,type:"button",class:_(["seg-btn",{active:e.value===n.sort}]),onClick:l=>$(e.value)},y(e.label),11,kt)),64))])])])]))}}),_t=Y(gt,[["__scopeId","data-v-06a3b5fd"]]),wt={class:"container-fluid py-3 portal-page"},Ct={class:"head-wrap"},$t={class:"cat seg mt-2",role:"group","aria-label":"分类"},xt={class:"d-flex justify-content-center py-4"},St=["disabled"],Tt={key:1,class:"text-secondary small"},Wt=X({__name:"index",setup(s){const a=v("desktop"),n=v(""),h=v("image"),p=v("default"),c=v("all"),u=R(()=>a.value==="mobile"?[{key:"all",label:"全部"},{key:"4k",label:"4k"},{key:"dark",label:"黑暗"},{key:"minimal",label:"极简"},{key:"anime",label:"二次元"},{key:"nature",label:"自然"}]:a.value==="avatar"?[{key:"all",label:"全部"},{key:"girl",label:"女生"},{key:"boy",label:"男生"},{key:"anime",label:"二次元"},{key:"cute",label:"可爱"},{key:"simple",label:"简约"}]:[{key:"all",label:"筛选条件"},{key:"8k",label:"8k壁纸"},{key:"4k",label:"4k"},{key:"wide",label:"宽屏桌面"},{key:"black",label:"黑暗"},{key:"minimal",label:"极简"},{key:"cyber",label:"赛博"},{key:"nature",label:"自然"}]),b=R(()=>{const i=a.value==="desktop"?"桌面":a.value==="mobile"?"手机":"头像",e=u.value.find(K=>K.key===c.value)?.label,l=n.value.trim();return l?`${l} ${i} 图片`:e&&e!=="筛选条件"&&e!=="全部"?`${e} ${i} 图片`:`${i} 图片`}),z=R(()=>"点击图片可在新窗口打开"),C=v(1),V=v(24),x=v(0),f=v([]),$=v(!1),g=v(0),S=R(()=>f.value.length<x.value),T=async(i=!1)=>{if($.value||!i&&!S.value&&f.value.length>0)return;const e=++g.value;$.value=!0;try{const l=await J({category:a.value,keyword:n.value.trim()||void 0,page:i?1:C.value,pageSize:V.value});if(e!==g.value)return;x.value=l.total,C.value=l.page,V.value=l.pageSize,i?f.value=l.list:f.value=[...f.value,...l.list]}finally{e===g.value&&($.value=!1)}},W=async()=>{c.value=n.value.trim()?"custom":c.value,C.value=1,f.value=[],x.value=0,await T(!0)},I=i=>{p.value=i},M=async i=>{c.value=i.key,i.key==="all"?n.value="":n.value=i.label,await W()},L=async i=>{const e=u.value.find(l=>l.key===i);e&&await M(e)},o=async()=>{C.value+=1,await T(!1)};return F(()=>a.value,async()=>{c.value="all",n.value="",C.value=1,f.value=[],x.value=0,await T(!0)},{immediate:!0}),(i,e)=>(r(),d("div",wt,[t("div",Ct,[w(_t,{title:b.value,subTitle:z.value,mediaType:h.value,keyword:n.value,loading:$.value,sort:p.value,total:x.value,chips:u.value,activeChip:c.value,"onUpdate:keyword":e[0]||(e[0]=l=>n.value=l),onSearch:W,onChangeMediaType:e[1]||(e[1]=l=>h.value=l),onChangeSort:I,onSelectChip:L},null,8,["title","subTitle","mediaType","keyword","loading","sort","total","chips","activeChip"]),t("div",$t,[t("button",{type:"button",class:_(["seg-btn",{active:a.value==="desktop"}]),onClick:e[2]||(e[2]=l=>a.value="desktop")}," 桌面 ",2),t("button",{type:"button",class:_(["seg-btn",{active:a.value==="mobile"}]),onClick:e[3]||(e[3]=l=>a.value="mobile")}," 手机 ",2),t("button",{type:"button",class:_(["seg-btn",{active:a.value==="avatar"}]),onClick:e[4]||(e[4]=l=>a.value="avatar")}," 头像 ",2)])]),e[5]||(e[5]=t("div",{class:"divider"},null,-1)),(r(),A(Pe,{key:a.value,category:a.value,list:f.value},null,8,["category","list"])),t("div",xt,[S.value?(r(),d("button",{key:0,class:"btn btn-outline-secondary",type:"button",disabled:$.value,onClick:o},y($.value?"加载中...":"加载更多"),9,St)):(r(),d("span",Tt,"没有更多了"))])]))}}),Lt=Y(Wt,[["__scopeId","data-v-b9355716"]]);export{Lt as default};
